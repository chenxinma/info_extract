# 划词信息项标记功能规范

## 目的
为文本信息结构化提取准备训练数据，通过划词标注的方式让用户可以标记文本中的关键信息项。

## 功能需求

### 需求1：示例文本管理
系统应允许用户管理标注用的示例文本片段。

#### 场景1.1：查看示例文本列表
- 当用户打开划词标注页面时
- 系统应显示所有已保存的示例文本列表
- 每个示例文本显示ID和内容摘要

#### 场景1.2：添加新示例文本
- 当用户点击"添加新示例"按钮时
- 系统应清除文本编辑区域
- 系统应创建一个新的空白示例条目并加入列表
- 系统应自动选中新创建的示例

#### 场景1.3：选择示例文本
- 当用户点击列表中的某个示例文本时
- 系统应在文本编辑区域显示该示例的内容
- 系统应加载与该示例相关的所有标注记录
- 系统应更新标注结果表格

#### 场景1.4：删除示例文本
- 当用户点击示例列表中的删除按钮时
- 系统应弹出确认对话框
- 如果用户确认删除，系统应从数据库和界面删除该示例及其所有相关标注记录
- 如果删除的是当前显示的示例，系统应清空编辑区域和标注结果表格

### 需求2：划词标注功能
系统应提供直观的划词标注功能。

#### 场景2.1：选择文本
- 当用户在文本编辑区域选择一段文字时
- 系统应启用所有信息项标注按钮
- 系统应记录选中的文本内容和位置

#### 场景2.2：执行标注
- 当用户选中文本并点击信息项类型按钮时
- 系统应将选中的文本替换为标记元素（使用颜色或其他视觉标识）
- 系统应将此次标注记录添加到当前示例的标注集合中
- 系统应更新标注结果表格
- 系统应清除文本选择状态并禁用信息项按钮

#### 场景2.3：取消选择
- 当用户在文本编辑区外点击或选择其他内容时
- 系统应禁用信息项按钮

### 需求3：标注结果管理
系统应允许用户查看、编辑和管理标注结果。

#### 场景3.1：查看标注结果
- 当加载示例文本时
- 系统应在表格中显示与该示例关联的所有标注记录
- 表格应包括文本内容、信息项类型和属性列

#### 场景3.2：添加属性到标注
- 当用户在表格中选择一个标注记录并填写属性键值后点击添加按钮时
- 系统应将新属性添加到选定的标注记录中
- 系统应更新表格中该标注的属性列

#### 场景3.3：删除标注
- 当用户点击标注记录对应的删除按钮时
- 系统应从当前示例的标注集合中移除该记录
- 系统应更新表格显示

### 需求4：数据持久化
系统应安全地存储用户创建的标注数据。

#### 场景4.1：保存标注
- 当用户点击"保存"按钮时
- 系统应将当前示例文本及其所有标注数据同步到服务器
- 系统应显示保存成功的反馈

#### 场景4.2：保存示例文本
- 当用户修改文本编辑区域的内容并保存时
- 系统应将更改同步到服务器
- 如当前为新示例，则创建新记录；如为现有示例，则更新记录

## 非功能性需求

### 性能需求
- 界面响应时间应小于200ms
- 标注操作后的界面更新应在50ms内完成
- 支持至少1000个示例文本的快速加载和搜索

### 可用性需求
- 界面设计应遵循一致性原则，符合用户习惯
- 提供清晰的操作指引，帮助用户了解如何使用功能
- 错误信息应明确易懂，指导用户如何纠正

### 兼容性需求
- 支持现代主流浏览器（Chrome, Firefox, Safari, Edge）
- 支持触摸屏设备的基本操作
- 界面在不同屏幕尺寸下都能正常显示和操作

## 接口规范

### 前端界面组件
- 示例文本列表区域：显示所有示例文本，支持添加、删除、选择操作
- 文本编辑区域：使用contenteditable元素，支持文本输入、粘贴和划词选择
- 信息项按钮组：根据当前信息项配置动态生成，初始时禁用，有文本选择时启用
- 标注结果表格：展示当前示例的所有标注记录，支持查看、编辑、删除操作
- 属性管理区域：允许为选中的标注记录添加自定义属性
- 操作按钮区：包含保存、重置等操作按钮

### 后端API接口
- `/api/example` - 示例文本管理的标准CRUD接口
- `/api/extractions` - 标注记录管理的标准CRUD接口
- `/api/extractions/{extraction_id}/attributes` - 标注属性管理的CRUD接口