# 结构化信息提取工具

## 项目简介

本项目是一个结构化信息提取工具，可以从用户提供的邮件文件（eml、msg格式）和Excel文件中按照统一的信息项规格提取信息，并生成标准的Excel文本。

工具通过自动化处理，能够显著提升人力资源服务方处理客户入职、离职等人员信息的效率，减少人工录入工作量，降低错误率，并支持灵活适配客户多变的信息格式。

## 核心功能

1. **多格式邮件处理**：支持处理eml和msg格式的邮件文件，包括邮件正文和附件
2. **Excel文件解析**：支持解析xls和xlsx格式的Excel文件，自动识别表头并提取数据
3. **智能信息提取**：
   - 使用大语言模型从邮件正文中提取结构化信息
   - 使用规则+AI的方式处理Excel表格数据
4. **标准化输出**：将提取的信息按照统一格式输出为标准的Excel文件

## 支持的输入格式

- 邮件文件：eml、msg
- 表格文件：xls、xlsx

## 输出格式

- 标准化Excel文件，包含统一的信息项字段

## 使用方法

1. 将需要处理的邮件文件（eml、msg）或Excel文件放入 `source` 目录
2. 运行命令：`uv run info-extract --work_dir .`
3. 程序会自动处理所有文件，并将结果输出到 `destination` 目录

## 处理流程

```mermaid
%% 本地桌面的结构化信息提取工具

flowchart LR
    id1[\源文件\]
    id1-->extract([info_extract])
    extract-->f[\标准化Excel\]
```

## 信息项规格

工具按照以下统一信息项规格提取信息：

- 作业：入职/离职/变更
- 证件号码
- 姓名
- 客户名称
- 户籍
- 用工模式
- 入职日期
- 合同终止日期
- 离职日期
- 社保缴纳城市
- 社保基数
- 公积金基数
- 社保最后缴纳月
- 公积金最后缴纳月
- 成本中心
- 内部工号
- 备注

## 技术架构

本工具基于Python开发，主要依赖包括：
- `msg-parser`：用于解析Microsoft Outlook的msg文件
- `extract-msg`：用于处理msg格式邮件文件
- `openpyxl`：用于处理Excel文件
- `pandas`：用于数据处理
- `pydantic-ai`：用于AI信息提取
- `langextract`：用于文本信息提取

## 错误处理

- 程序会自动处理各种文件格式的异常情况
- 处理失败的文件会被移动到 `error` 目录
- 所有处理过程和错误信息都会记录在日志中

## 设计文档

项目的详细设计文档位于 `docs/` 目录中，包括：

- `specs/`: 各模块的详细规格说明
  - `source/`: 源文件处理模块规格
  - `extract/`: 信息提取模块规格
  - `destination/`: 输出模块规格
- `changes/`: 功能变更和新增功能的设计文档
  - `add-pdf_source/`: 添加PDF源支持的示例设计文档