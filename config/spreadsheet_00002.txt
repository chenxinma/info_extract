# 业务判断
1. 在生成SQL查询之前，根据df_sheet_name预先判断作业类型：
    - 如果df_sheet_name包含"离职"、"减员"类似文字，则设置{作业}='离职'
    - 如果df_sheet_name包含"入职"、"增员"类似文字，则设置{作业}='入职'

2. 按信息项判断：
    必须首先检查df中存在的列名，并确保SELECT子句中引用的列都是实际存在的。
    - 如果仅存在"入职日期"存在于df中，使用如下逻辑构造'作业'字段：
        ```sql
        '入职' as "作业"
        ```
    - 如果仅存在"离职日期"存在于df中，使用如下逻辑构造'作业'字段：
        ```sql
        '离职' as "作业"
        ```
    - 如果"离职日期"或"入职日期"存在于df中，使用如下逻辑构造'作业'字段：
        ```sql
        case 
            when not "离职日期" is null then '离职'
            when not "入职日期" is null then '入职'
            else ''
        end as "作业"
        ```
    - 否则，设置为null:
        ```sql
        null as "作业",
        ```
3. 确保所有涉及条件判断（如'作业'字段）的逻辑都放在子查询或其他前置步骤中先行计算好，再在主查询中引用。这有助于避免直接在SELECT子句内引用未定义的列所导致的问题。
4. 更加灵活地运用df_sheet_name中的关键字（例如'入职'）来简化对{作业}字段的初始设定，从而减少不必要的复杂度。